function Remainder(a,b){this.monthly=a,this.tips=b,remainder=a-b}function HourlyWage(a,b){this.tips=a,this.hours=b,this.wage=a/b}function MedalPercentage(a,b){this.tips=a,this.daily=b,this.medal=function(){return a>=b?"Gold":b/100*85>=a&&a>=b/100*71?"Silver":b/100*70>=a&&a>=b/100*50?"Bronze":""}}$(document).ready(function(){myEarnings.init()}),myEarnings={init:function(){this.initStyling(),this.initEvents()},initStyling:function(){this.renderEarnings()},initEvents:function(){$(".calculate").on("click",this.calculateScore),$(".journalEntries").on("click","button",function(){$("#myModal").modal()}),$("#newEntryForm").on("submit",this.addEntry);$(this).closest(".scoreItem").data("postid");$("#editEntryModal").modal()},calculateScore:function(a){a.preventDefault();var b=$(".currentDate").val(),c=$(".monthGoal").val(),d=$(".dayGoal").val(),e=$(".tips").val(),f=$(".hours").val(),g=e/f,h=c-e,i=new MedalPercentage(e,d),j=i.medal();window.earningsObj={Date:b,Hourly:g,Medal:j,Remainder:h,JournalEntry:""},myEarnings.addEarnings(earningsObj),myEarnings.render($(".totalScore"),Templates.scoreCurrent,earningsObj);var k=d||0,l=d/100*85,m=d/100*70;$(".gold").html(k),$(".silver").html(l),$(".bronze").html(m)},render:function(a,b,c){var d=_.template(b,c);a.html(d)},renderEarnings:function(){$.ajax({url:"http://tiy-fee-rest.herokuapp.com/collections/ServeMeAppScore",type:"GET",dataType:"json",error:function(){alert("problem")},success:function(a){console.log(a);var b=window.earningsData=a;myEarnings.render($(".scoreContent"),Templates.score,b)}})},renderEntry:function(){$.ajax({url:"http://tiy-fee-rest.herokuapp.com/collections/ServeMeAppJournal",type:"GET",dataType:"json",error:function(){alert("you broke the internet")},success:function(a){var b=window.entries=a;myEarnings.render($("section"),Templates.entries,b)}})},addEntry:function(a){a.preventDefault();var b=$(this).closest(".scoreItem"),c=b.data("entryid");console.log(c);var d={Date:$(this).closest(".date").text(),Hourly:$(this).closest(".wage").text(),Medal:$(this).closest(".medal").text(),Remainder:$(this).closest(".remainder").text(),JournalEntry:$(".entryContentForm").val()};$.ajax({url:"http://tiy-fee-rest.herokuapp.com/collections/ServeMeAppScore/"+c,type:"PUT",data:d,dataType:"json",error:function(){alert("couldn't add entry")},success:function(){$(".newEntryTitle").val(""),$(".entryContentForm").val(""),$("#myModal").modal("hide"),myEarnings.renderEntry(),myEarnings.renderEarnings(),myEarnings.renderSideBar()}})},addEarnings:function(a){$.ajax({url:"http://tiy-fee-rest.herokuapp.com/collections/ServeMeAppScore",type:"POST",data:a,error:function(){alert("you fucked up")},success:function(){myEarnings.renderEarnings()}})}},Templates={},Templates.score=["<% _.each(earningsData, function(earningsData, index , list) { %>",'<div data-entryid="<%= earningsData._id %>"class="scoreItem">','<ul class="totalScore">','<li>Date: <span class="date"><%= earningsData.Date %></span></li>','<li>Hourly Wage: <span class="wage"><%= earningsData.Hourly %></span></li>','<li>Medal: <span class="medal"><%= earningsData.Medal %></span></li>','<li>Remainder:<span class="remainder"><%= earningsData.Remainder%></span></li>',"</ul>","</div>","<br>","<% }); %>"].join("\n"),Templates.scoreCurrent=['<div class="totalScore">','<ul class="totalScore">',"<li>Date: <%= earningsObj.Date %></li>","<li>Hourly Wage: <%= earningsObj.Hourly %></li>","<li>Medal: <%= earningsObj.Medal %></li>","<li>Remainder: <%= earningsObj.Remainder %></li>","</ul>","</div>"].join("\n"),Templates.modal=['<div class="modal-body">','<div class="form-group">','<label for="editPostTitle">Edit Title</label>','<input type="text" class="form-control editPostTitle" id="editPostTitle" value="<%= post.title %>">',"</div>",'<div class="form-group">','<label for="editAuthorPostForm">Author of Post</label>','<input type="text" class="form-control editAuthorPostForm" id="authorPostForm" value="<%= post.author %>">',"</div>",'<div class="form-group">','<label for="editContentForm">Post</label>','<textarea id="editContentForm" class="form-control editContentForm"><%= post.content %></textarea>','<p class="help-block">Example block-level help text here.</p>',"</div>","</div>",'<div class="modal-footer" data-postId="<%= post._id %>">','<input id="editPostId" type="hidden" value="<%= post._id %>">','<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>','<button type="button" class="btn btn-primary submitUpdatePost">Save changes</button>',"</div>"].join("\n");